{"version":3,"sources":["webpack:///./app/components/Socket.js"],"names":["Socket","props","connectToSocket","socket","io","myBook","stock","portfolio","push","symbol","on","forEach","emit","handleSocketMessage","JSON","parse","message","setState","portfolioSize","Object","keys","length","state","currentPortfolio","portfolioChanged","close","height","width","React","Component","mapStateToProps","Portfolio_state","mapDispatchToProps","dispatch","actions"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;;;;;;;;;;;IAEMA,M;;;AAEJ,kBAAYC,KAAZ,EAAmB;AAAA;;AAAA,gHACXA,KADW;;AAAA,UAQnBC,eARmB,GAQD,YAAM;;AAEtB,UAAMC,SAASC,GAAG,wCAAH,CAAf;;AAEA,UAAMC,SAAS,EAAf;;AAEA,WAAK,IAAIC,KAAT,IAAkB,MAAKL,KAAL,CAAWM,SAA7B,EAAuC;;AAErCF,eAAOG,IAAP,CAAY,MAAKP,KAAL,CAAWM,SAAX,CAAqBD,KAArB,EAA4BG,MAAxC;AACD;;AAEDN,aAAOO,EAAP,CAAU,SAAV,EAAqB,YAAM;;AAEzBL,eAAOM,OAAP,CAAgB,iBAAO;AACrBR,iBAAOS,IAAP,CAAY,WAAZ,EAAyBN,KAAzB;AACD,SAFD;AAGD,OALD;;AAOAH,aAAOO,EAAP,CAAU,SAAV,EAAqB,mBAAW;;AAE9B,cAAKT,KAAL,CAAWY,mBAAX,CAA+BC,KAAKC,KAAL,CAAWC,OAAX,CAA/B;AACD,OAHD;;AAKA,YAAKC,QAAL,CAAc,EAAEd,cAAF,EAAUe,eAAeC,OAAOC,IAAP,CAAY,MAAKnB,KAAL,CAAWM,SAAvB,EAAkCc,MAA3D,EAAd;AACD,KAhCkB;;AAGjB,UAAKC,KAAL,GAAY,EAAZ;AAHiB;AAMlB;;;;;;;;;;;AA8BKC,gC,GAAmBJ,OAAOC,IAAP,CAAY,KAAKnB,KAAL,CAAWM,SAAvB,EAAkCc,M;AAErDG,gC,GAAmBD,qBAAqB,KAAKD,KAAL,CAAWJ,a;;qBAEnDM,gB;;;;;;uBAGI,KAAKF,KAAL,CAAWnB,MAAX,CAAkBsB,KAAlB,E;;;;AAEN,qBAAKvB,eAAL;;;;;;;;;;;;;;;;;;wCAIe;AACjB,WAAKA,eAAL;AACD;;;6BAEQ;AACP,aACE,uCAAK,OAAO,EAACwB,QAAQ,GAAT,EAAcC,OAAO,GAArB,EAAZ,GADF;AAGD;;;;EA3DkBC,gBAAMC,S;;AA8D3B,IAAMC,kBAAkB,SAAlBA,eAAkB,QAAyB;AAAA,MAAtBC,eAAsB,SAAtBA,eAAsB;;AAC7C,SAAO;AACLxB,eAAYwB,gBAAgBxB;AADvB,GAAP;AAGD,CAJH;;AAMA,IAAMyB,qBAAqB,SAArBA,kBAAqB;AAAA,SAAa;;AAEpCnB,yBAAqB,6BAACG,OAAD;AAAA,aAAWiB,SAASC,gCAAQrB,mBAAR,CAA4BG,OAA5B,CAAT,CAAX;AAAA;AAFe,GAAb;AAAA,CAA3B;;kBAKe,yBACXc,eADW,EAEXE,kBAFW,EAGbhC,MAHa,C","file":"./modules/1.1e5de6a5c1a3c41ad0f8.js","sourcesContent":["import React from 'react';\nimport { connect } from \"react-redux\";\nimport symbolHash from './symbolHash.json'\nimport  actions  from \"../../store/Portfolio/actions_for_Portfolio.js\"\n\nclass Socket extends React.Component {\n \n  constructor(props) {\n    super(props);\n    \n    this.state ={ \n\n    }\n  }\n\n  connectToSocket = () => {\n\n    const socket = io('https://ws-api.iextrading.com/1.0/last')\n    \n    const myBook = []\n    \n    for (let stock in this.props.portfolio){\n\n      myBook.push(this.props.portfolio[stock].symbol)\n    }\n\n    socket.on('connect', () => {\n\n      myBook.forEach( stock=>{\n        socket.emit('subscribe', stock)\n      })\n    })\n\n    socket.on('message', message => {\n    \n      this.props.handleSocketMessage(JSON.parse(message))\n    })\n\n    this.setState({ socket, portfolioSize: Object.keys(this.props.portfolio).length })\n  }\n\n  async componentDidUpdate(){\n\n    let currentPortfolio = Object.keys(this.props.portfolio).length\n\n    let portfolioChanged = currentPortfolio !== this.state.portfolioSize\n\n    if( portfolioChanged ){\n\n      // otherwise we get a memory leak\n      await this.state.socket.close()\n      \n      this.connectToSocket()\n    }\n  }\n\n  componentDidMount(){\n    this.connectToSocket()\n  }\n\n  render() {\n    return (\n      <div style={{height: \"0\", width: \"0\"}}></div>\n    );\n  }\n}\n\nconst mapStateToProps = ({ Portfolio_state }) => {\n    return {\n      portfolio : Portfolio_state.portfolio,\n    };\n  };\n  \nconst mapDispatchToProps = dispatch => ({\n\n    handleSocketMessage: (message)=>dispatch(actions.handleSocketMessage(message))\n});\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(Socket);"],"sourceRoot":""}